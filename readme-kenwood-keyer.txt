Приложение для программного осуществления CW манипуляции. Для его использования не нужно
ничего подключать к разъему ключа в трансивере, необходимо только соединение по COM
порту с радиостанцией. Для RS-232 будут нужны только контакты GND, RX, TX (RTS и CTS если 
у вас аппаратное управление потоком).
Работает с трансиверами Kenwood и другими, использующими протокол CAT Kenwood
и поддерживающими команды TX; RX;

Используйте программу на свой страх и риск

Быстрый старт

1. Создайте пару виртуальных COM портов с помощью прграммы com0com или другой.
В настройках созданных портов отметьте галочкой "Use port class", "emulate baudrate",
"enable buffer overrun" (для com0com) для обоих портов пары. Если используется не
com0com, то нужно настроить порты так, чтобы они вели себя как физические порты.

2. Далее переходим в программу, которая будет осуществлять CW манипуляцию, и,
если нужно, считывать частоту трансивера и управлять им (далее - Логгер).
В Логгере нужно выбрать один порт из пары, созданной на шаге 1, как порт для CW
и как порт для CAT.
Устанавливаем требуемую скорость и количество стоп-бит. Эти настройки должны быть
одинаковыми в Логгере, в программе kenwood keyer и в трансивере.
Если есть настройка управления потоком, выберите "no flow control" (управление потоком не используется)
В настройках порта для CW необходимо выбрать выход CW: RTS или DTR. На неиспользуемом выходе
установить низкий уровень. PTT не используется.
Важно понимать, что уровни на виртуальном порте не влияют на уровни в физическом порте,
к которому подключен трансивер. Это значит, что если радиостанции нужен
высокий уровень на каком нибудь контакте порта, вы не сможете его установить
с помощью Логгера.

3. В программе kenwood keyer из списка virtual port выбираем второй порт из созданной пары на шаге 1
(НЕ тот, который указали в Логгере). В rig port выбираем порт, к которому подключен трансивер.
В списках отображаются порты, доступные на момент запуска прогаммы, для обновления списка
программу необходимо перезапустить.
Скорость (baudrate) и стоп-биты нужно выбрать такие же, как в Логгере и трансивере.
Эти настройки применяются как для virtual port, так и для rig port.
Flow control - управление потоком, влияет только на Rig port. CW pin нужно указать тот, который
выбрали в Логгере.
Кнопка "Сохранить" сохраняет и применяет все настройки (вкл. имя портов), "Применить" - применяет
указанные настройки (не рекомендуется использовать во время передачи CW сообщения), но не сохраняет.
"Старт" - запуск программы. Нажимаем, когда все настроено и готово.
kenwood_keyer.exe нужно выполнять только из папки Compiled_App64. При неободимости создайте ярлык.


Альтернативы и повышение надежности программы

Если у ввс есть возможность манипулировать CW другим способом, лучше воспользоваться им.
Например, некоторые Логгеры поддерживают CW манипуляцию через CAT: если в вашем трансивере есть такая функция,
то манипуляцию можно осуществлять командой KY (см. документацию к CAT Kenwood). Такая возможность есть в
программе TR4W. В командах конфигурации нужно в пункте 'RADIO ONE CW BY CAT' и 'RADIO ONE CW SPEED SYNC' (или RADIO TWO)
установить значения 'TRUE'. Этот способ удобен и не требует никаких подключений, кроме соединений разъемов DB9
трансивера и компьютера.

Если вы все же будете использовать Kenwood keyer
отключите в настройках Логгера опрос трансивера во время передачи CW сообщения, если это возможно.

То, что приходит в Rig port, отправляется в Virtual port, и наоборот. Когда Логгер меняет уровень на CW pin,
в Rig port отправляется команда RX; или TX; (перейти в режим приема/передачи соответственно) в зависимости от уровня.
Во-первых, недостаток использования этих команд в том, что они равносильны нажатию кнопки Send (на TS-570), почти как PTT.
И каждый раз при передаче тире или точки будет переключаться реле (которое подключает к антенне приемник и передатчик),
А при передаче CW ключом (при стандартных настройках) или с помощью команды KY оно будет переключаться только в начале
и в конце сообщения.
Во-вторых, если будет передана TX;, а RX; не дойдет до трансивера, то он продолжит передавать несущую. Чтобы перейти
в режим приёма нужно будет нажать кнопку Send.
Команды по CAT могут не доходить из-за нестабильной связи ПК с трансивером. Тогда нужно уменьшить скорость,
экранировать кабель или использовть аппаратное управление потоком, если таковое предусмотрено. В этом случае
у любого способа CW манипуляции примерно одинаковая вероятность сбоя.
Сбои согут происходить по вине Kenwood keyer, т.к. опрос трансивера и смена уровня CW pin происходят асинхронно
(на самом деле это не совсем так, но в программе у команд RX/TX нет приоритета над другими, приходящими из virtual port).
В самых первых версиях на тестах было обнаружено, что при небольшой разницей во времени отправки Логгером команды
(например, IF;) и смене уровня CW pin (например, на высокий) команда TX; могла быть передана во время передачи IF;
(уже по rig port). То есть, вместо "IF; TX;" трансивер получал что-то вроде "ITX;F;", при этом CAT зависал или просто не
реагировал на неизвестную команду. Это было исправлено, и на следующих тестах эта ошибка не была обнаружена.
Сейчас в таком случае все еще сохраняется риск потерять связь с трансивером. Команды могут быть переданы сразу
один сообщением. Т.е. в буфер порта будет записано и незамедлительно передано 6 байт: IF;TX;. Было замечено,
что если передать сразу без паузы несколько команд, то CAT зависнет. Для корректной работы CAT между
командами нужно делать паузу. Если ваш трансивер зависает по этой же причине, перезапустите его.
Можно поэкспериментировать со скоростью.

Чтобы снизить количество таких случаев, не нужно передавать никаких команд по CAT (опрос частоты и т.д.) во время
передачи CW сообщения. В TR4W это "NO POLL DURING PTT". Нужно установить "TRUE", возможно придется назначить
pin для PTT

